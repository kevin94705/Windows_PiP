# Windows PiP (Picture-in-Picture) 瀏覽器視窗擷取工具

這是一個用 C\# WinForms 開發的 Windows 桌面應用程式，可以擷取瀏覽器視窗內容並以 Picture-in-Picture 模式顯示。

## 主要功能

### 視窗擷取

- 自動偵測並列出常見瀏覽器視窗 (Brave、Chrome、Edge、Firefox)
- 即時擷取選定視窗的內容 (30 FPS 更新率)
- 支援視窗區域裁切功能


### Picture-in-Picture 模式

- 視窗置頂顯示
- 可調整透明度 (20%-100%)
- 支援點擊穿透模式
- **可自由調整視窗大小 (50%-200% 縮放)**
- **基於基準尺寸 (480x320) 的比例縮放**


### 區域選取功能

- 視覺化區域選取介面
- 拖拉滑鼠選定擷取範圍
- 顯示選取區域座標和尺寸


### 智慧工具列管理

- **穿透模式時自動隱藏工具列**
- **取消穿透時自動顯示工具列**
- 完全隱藏整個工具列面板以節省空間


## 操作介面

### 主要控制項

#### 第一行控制項

- **視窗選擇下拉選單**: 選擇要擷取的瀏覽器視窗
- **重新整理按鈕 (⟳)**: 重新掃描可用視窗
- **切換穿透按鈕**: 開啟/關閉點擊穿透功能
- **區塊選取按鈕**: 進入區域選取模式
- **關閉按鈕 (✕)**: 關閉應用程式


#### 第二行：透明度控制

- **透明度滑桿**: 調整視窗透明度 (20%-100%)
- **透明度百分比顯示**: 即時顯示當前透明度數值
- **透明度重設按鈕**: 快速回到 100% 不透明


#### **第三行：視窗尺寸控制**

- **視窗大小滑桿**: 調整整體視窗尺寸 (50%-200%)
- **尺寸百分比顯示**: 即時顯示當前縮放比例
- **尺寸重設按鈕**: 快速回到 100% 標準尺寸
- **快捷尺寸按鈕**:
    - **小 (75%)**: 適合小螢幕或多視窗環境
    - **中 (100%)**: 標準尺寸
    - **大 (150%)**: 適合大螢幕或重要內容


## 快捷鍵

| 快捷鍵 | 功能 |
| :-- | :-- |
| `Ctrl + Shift + T` | 切換點擊穿透模式 |
| `Ctrl + +` | 增加透明度 (+10%) |
| `Ctrl + -` | 減少透明度 (-10%) |
| **`Ctrl + Shift + +`** | **放大視窗尺寸 (+10%)** |
| **`Ctrl + Shift + -`** | **縮小視窗尺寸 (-10%)** |

## 區域選取模式

### 使用步驟

1. 點擊「區塊選取」按鈕
2. 系統擷取完整視窗畫面
3. 使用滑鼠拖拉選定區域
4. 系統自動計算並套用新的擷取範圍
5. 顯示選取結果的座標資訊

### 視覺化提示

- 紅色邊框標示選取區域
- 半透明紅色填充顯示範圍
- 滑鼠游標變為十字準星


## 設定檔案

應用程式會自動儲存以下設定到 `%APPDATA%\PiPTool\settings.json`:

```json
{
  "WindowX": 100,
  "WindowY": 100,
  "WindowWidth": 480,
  "WindowHeight": 320,
  "CutX": 0,
  "CutY": 0,
  "CutWidth": 480,
  "CutHeight": 270,
  "LastSelectedWindow": "",
  "WindowOpacity": 100,
  "FormScale": 100
}
```

**新增設定項目說明:**

- **`FormScale`**: 儲存視窗縮放比例 (50-200)


## 技術特色

### 高效能擷取

- 使用 `PrintWindow` API 進行視窗擷取
- 33ms 更新間隔實現流暢畫面
- 智能記憶體管理避免洩漏


### **智慧視窗管理**

- **比例縮放**: 基於基準尺寸進行等比例縮放
- **自動工具列控制**: 穿透模式自動隱藏，正常模式自動顯示
- **即時尺寸調整**: 支援滑桿拖拉和快捷按鈕
- WinAPI 整合實現無邊框視窗
- 自定義標題列和調整手柄
- 支援視窗拖拉和邊緣調整大小


### 自動化功能

- **啟用穿透時自動隱藏工具列最大化顯示區域**
- **取消穿透時自動顯示工具列方便操作**
- 延遲儲存設定避免頻繁寫入
- **即時儲存縮放設定**


## 系統需求

- Windows 10/11
- .NET 6.0 或更高版本
- 支援的瀏覽器: Brave、Chrome、Edge、Firefox


## 適用場景

- **小視窗模式**: 線上會議時監看聊天室
- **標準模式**: 影片播放時查看其他內容
- **大視窗模式**: 重要簡報或文件參考
- 程式開發時參考文件
- 遊戲直播時顯示聊天訊息
- **多螢幕環境**: 不同螢幕尺寸的最佳化顯示
- **靈活工作流程**: 根據內容重要性調整視窗大小


## **尺寸調整功能詳解**

### **智慧縮放系統**

- **基準尺寸**: 480x320 像素作為 100% 基準
- **縮放範圍**: 50% (240x160) 至 200% (960x640)
- **等比例縮放**: 維持 3:2 寬高比例
- **即時預覽**: 拖拉滑桿時即時調整視窗大小


### **使用者體驗優化**

- **快捷按鈕**: 一鍵切換常用尺寸
- **視覺回饋**: 百分比數值即時更新
- **設定記憶**: 自動儲存和載入上次使用的尺寸
- **鍵盤支援**: 快捷鍵進行精確調整

這個工具特別適合需要同時監看多個應用程式的使用者，提供了**靈活的視窗尺寸控制**、高品質的即時擷取功能，以及**智慧化的工具列管理系統**。無論是在小螢幕筆電還是大型桌面顯示器上，都能提供最佳的使用體驗 。[^1][^5][^6]