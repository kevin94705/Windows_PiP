# Windows PiP (Picture-in-Picture) 瀏覽器視窗擷取工具

這是一個用 C\# WinForms 開發的 Windows 桌面應用程式，可以擷取瀏覽器視窗內容並以 Picture-in-Picture 模式顯示。

## 主要功能

### 視窗擷取

- 自動偵測並列出常見瀏覽器視窗 (Brave、Chrome、Edge、Firefox)
- 即時擷取選定視窗的內容 (30 FPS 更新率)
- 支援視窗區域裁切功能


### Picture-in-Picture 模式

- 視窗置頂顯示
- 可調整透明度 (20%-100%)
- 支援點擊穿透模式
- 可自由調整視窗大小


### 區域選取功能

- 視覺化區域選取介面
- 拖拉滑鼠選定擷取範圍
- 顯示選取區域座標和尺寸


### 工具列管理

- 可隱藏/顯示工具列節省空間
- 穿透模式時自動隱藏工具列
- 緊湊模式僅顯示切換按鈕


## 操作介面

### 主要控制項

- **視窗選擇下拉選單**: 選擇要擷取的瀏覽器視窗
- **重新整理按鈕 (⟳)**: 重新掃描可用視窗
- **切換穿透按鈕**: 開啟/關閉點擊穿透功能
- **區塊選取按鈕**: 進入區域選取模式
- **工具列切換按鈕 (▲/▼)**: 隱藏/顯示完整工具列
- **透明度滑桿**: 調整視窗透明度
- **關閉按鈕 (✕)**: 關閉應用程式


### 透明度控制

- 滑桿範圍: 20% - 100%
- 即時預覽效果
- 重設按鈕快速回到 100%


## 快捷鍵

| 快捷鍵 | 功能 |
| :-- | :-- |
| `Ctrl + Shift + T` | 切換點擊穿透模式 |
| `Ctrl + Shift + H` | 切換工具列顯示/隱藏 |
| `Ctrl + +` | 增加透明度 (+10%) |
| `Ctrl + -` | 減少透明度 (-10%) |

## 區域選取模式

### 使用步驟

1. 點擊「區塊選取」按鈕
2. 系統擷取完整視窗畫面
3. 使用滑鼠拖拉選定區域
4. 系統自動計算並套用新的擷取範圍
5. 顯示選取結果的座標資訊

### 視覺化提示

- 紅色邊框標示選取區域
- 半透明紅色填充顯示範圍
- 滑鼠游標變為十字準星


## 設定檔案

應用程式會自動儲存以下設定到 `%APPDATA%\PiPTool\settings.json`:

```json
{
  "WindowX": 100,
  "WindowY": 100,
  "WindowWidth": 720,
  "WindowHeight": 480,
  "CutX": 0,
  "CutY": 0,
  "CutWidth": 480,
  "CutHeight": 270,
  "LastSelectedWindow": "",
  "WindowOpacity": 100,
  "ToolbarVisible": true
}
```


## 技術特色

### 高效能擷取

- 使用 `PrintWindow` API 進行視窗擷取
- 33ms 更新間隔實現流暢畫面
- 智能記憶體管理避免洩漏


### 視窗管理

- WinAPI 整合實現無邊框視窗
- 自定義標題列和調整手柄
- 支援視窗拖拉和邊緣調整大小


### 自動化功能

- 啟用穿透時自動隱藏工具列
- 取消穿透時自動顯示工具列
- 延遲儲存設定避免頻繁寫入


## 系統需求

- Windows 10/11
- .NET 6.0 或更高版本
- 支援的瀏覽器: Brave、Chrome、Edge、Firefox


## 適用場景

- 線上會議時監看聊天室
- 影片播放時查看其他內容
- 程式開發時參考文件
- 遊戲直播時顯示聊天訊息
- 多工作業時保持重要視窗可見

這個工具特別適合需要同時監看多個應用程式的使用者，提供了靈活的視窗管理和高品質的即時擷取功能。

